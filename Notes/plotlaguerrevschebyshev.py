from mpmath import *
import matplotlib.pyplot as plt
from main import *
cp = [mpf('0.999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999389'), mpf('2.61065232906792236661256570307813505976418305184559867571047740157011013097407484792469046710547474454538410837714438038686487398108183172187829788300815e-152'), mpf('-0.166666833477526735442401107435674172220110793387752493778573737037476377227156229328306083673104952596605171462049232302443045378374624175340686060403454'), mpf('0.00000889441236044042188267639332120395449263900212080695654538162389374171395926562092002535006749365199956551735634396548338579940545472764057514177211434529'), mpf('0.0249023997798559703726219366239817959185265679463177691917590522289380299597495753812894306045412760605156512184197231030819219195098962440939405316917044'), mpf('0.000485459934887731876044210464866324508259131040922493201103202699411337014416415174976655146193430476481264162034480184508794086932961123863699641569506732'), mpf('-0.00516812449372417238925614678590691393788412051775365263172347362310617158595863986226526749114720482889396935636947803405936553964376958578099510449372207'), mpf('0.00262110850434118516206180009819249701567671700377308095790973638762197181052257879132064567640382822772124226018114567678425663928235223351710957445335137'), mpf('-0.00284184001539703150082236441347825460087652462044968784005833204338465212257584675607968249138812649629430096302838639019797814283032779764222330108597105'), mpf('0.00319499171997960913311491945766396552683432378279041260190814808171623741292268417377906644249296230557904901569996671302212886986858066586883778234688015'), mpf('-0.00228060951177106618088022919975068597118201465413280986256674868211123420517208259862876350688455105823407344646413953424786890449625251329325377356956165'), mpf('0.00110954012591148180494733230415905935605436086279833873293891218543743801632169373756531906982487766647847516343613648667575917468084103970297151676758548'), mpf('-0.0003958833157830565726340102345636129831601001769028869504588798112059320238590432387352295594331301889805837053355727226840409165575062585308737413177888'), mpf('0.000108217634243560547816480064241692228216105991619558549262267420667894330686179980286644973072355006164626335267064017966015361062946688117112418205128313'), mpf('-0.0000232380021665033159396575150887717718185660210305640870106324866804894587245610183572893354759039253913137314009452711250045143456676730483695402682087965'), mpf('0.00000397329698849560407361290952246403317054183127776071856453681409616582481271613413110269324231015861586951792146387792846131578874545851176730828105423958'), mpf('-0.000000544045643983522431212934559945553576415278060049026411681167160626759702916477812023278070056010464579069221432996142307985053046590513786215179995490004'), mpf('0.0000000596256533182339049461116315378544587275048654256854852809618829498770383607623704119386664128500338273208315041619192762143249103167462949712325001722622'), mpf('-0.00000000519724707037687139963059562416310195821085500975442096075806009008044759323918182644203307846986933714549934518350139037549113882504963951463953793893471'), mpf('0.000000000355632027958458400251764189845353909780586908634500892193814657245746644936682723440548937041524823878488199129781752277563430070922556445287091257238959'), mpf('-0.0000000000186907644408515791426652302004721316042176383788615295715594789497890903451685912265876942000494937246709341198753162826825168272589821555656165464997225'), mpf('0.000000000000728209395921390364917644889123507171307861699102181177784997037773032887392875904809606424076002788832725911927711385035618009792520224715987081155585802'), mpf('-0.0000000000000198096170527680100019030083163969316775774258360350375272866864413149066648068731060621810032328940187487163812272991373297917905109076466423915765910838'), mpf('0.00000000000000033581554172735922852876844794523204649308419234720273468168978719139831487417791091210051224046988544756546353909167820979759729110529684625386532994167'), mpf('-0.00000000000000000267028532997367320311339176702926614913291275929309649065240761613644626205671985808085643061968523524913905799480701004165105941642703934122186138662478')]

lp = [mpf('1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061'), mpf('-2.3568356710592653308799450396862870926109650049337285785897997932931839696821573843598312653665351858622376666288442080592784220780911956407136280861511e-152'), mpf('-0.16680679822209938626002285449500732840607454022684306106681873877158185586463468968151270503956237184120908058332155040773176446031369579673612551314604'), mpf('0.00196448051478919301828384408780299978482708484086709697163948243106917925484815030449366325478267235601213838475476253521144336328153636608337923893819909'), mpf('0.0170391562912241886122108766639410151076847934135869516338471442334017783322268677484403041940216870576290394322199700981264011417831651917710313512932248'), mpf('0.0151570706369392422743938753026161909369522296326623324212118932700853738871489597881793023253814262811590119861116523223891290539624932849211306908744029'), mpf('-0.0199745070850873057960010090045534638829443854647824414702013440464723901688980469946795513795390811688453650850950188025224123392651168392298546544914687'), mpf('0.0104320906707491945848859891493129610158455385764376429866868342075432270623561908156277845699503086627897533880732484830484291304865863233549622880629145'), mpf('-0.00344561160196721268757899970395260154019887312685260203907360390890057820055264847697934265083173193342264881902095536624171414230527481528714466224753086'), mpf('0.000815782558930952239278307329661478909827229912907016946994082658197261596230921896624011825006192359189692194090805068800899736690412269009331322939492426'), mpf('-0.000146603215820600275004678449066141312177209494550811766210614199128172311278778711225803192486143646782838771305328325391670808168879748374208486035520145'), mpf('0.0000206563480859376030011630180561922398138913185253434537425279781336255737445291220756777532856625022906163149327189793627312071056817207206263508472411097'), mpf('-0.00000232947902953450982940907546922857912839527021313267294487128892815197501043923203171917857466146976373014608909757352155696243178589393973125634958055808'), mpf('0.000000213217669197610643836530167954318208730379447354259049845379164782506905568430725134694998375613558113555700352378479203815771240377358704059412860699997'), mpf('-0.0000000159941295440500041582003376449253250953164802250695255458645717208829680100384060113807382097611670266918340422216547900561925533292407969715719761259814'), mpf('0.000000000989851344222106987508473524915532394258145401656122235444943950007578730729539397411445545533760522049763499177276869985752449477504690086201431658677935'), mpf('-0.0000000000507603567812910545804323355686224156393909677369793859443844199200573211964923300668329699412503062825166440798155555020934854610268287372369596024528109'), mpf('0.0000000000021618542845290554755702739459825036072046771622859444714805367814750779055992361897963237245719466597049560991330546684710060141496646670357771471312108'), mpf('-0.0000000000000765020325326586695342505028170736116228633574367755544771865791479434848570622259727158758273248072804708391124533530649311920141336977538468945483750795'), mpf('0.00000000000000224625955340028238928862544246065964366340896304233253060099769599691601522948529971729072096014327421004766833648311676061940667990649679953076832295478'), mpf('-0.0000000000000000545406963660023373932504398626444923978521056935082128993725252785312798961649627295404422209068296765631047835026927720726129100912759191082059972740051'), mpf('0.00000000000000000108891601473637566404700365394861891874065964173001783715323496723406169964605795241693148793034043454958388629117375750404550576446775461260404236644456'), mpf('-0.0000000000000000000177253795154159175701162601727313133826934299501800251227489931383998001969203927462558365168043773895892473197379709719870316305147715812322747276698155'), mpf('0.000000000000000000000232396857188162771796279594624969062100842008013307745885816849041533808098590756938557040314716394378637485902362997845341262950780092877587003199395115'), mpf('-0.00000000000000000000000241184525735959141299656543297650116912479065226979112074594631224715427028457097437350603277812666030355176781697409245252601043187366228862271566883644'), mpf('0.00000000000000000000000001931987310143306500095830871058596080473341602494834129928058486069613591929005390976280526667155810813749506018348237977581874139972047720837175044556'), mpf('-0.000000000000000000000000000114986663887520787831224013781929979369097138197497934683791892865950555478010468143416368571518058147316880056511605542263324616659107119969048483742511'), mpf('0.00000000000000000000000000000047790439154631064631184387688060299480228159080540127054432647562197515907671854349047329581902889797468487205345233944899791290666896216343349287917039'), mpf('-0.00000000000000000000000000000000123578637502138894957412907431362028419253576083566768701573222565237497955184876013135313683365200459605944119129464987335543963120147002756830942942108'), mpf('0.00000000000000000000000000000000000149436474407046701459556335185503440715963703308056651073494416961463866137331176162479177535260435559680639549045535861267044219452864354947519732956405')]

plt.clf()
plt.grid()
plt.title("Laguerre Basis vs the Chebyshev Basis (for [0,10]) on [0,30]")
ax = plt.gca()

ax.set_ylim([-2, 1.3])

D = [0,30]
points = 200
dx = (D[1]-D[0])/points
plt.xlabel("x")
plt.ylabel("y")
xlist = [D[0]+i*dx for i in range(points+1)]

cylist = [polyeval(cp,x) for x in xlist]
lylist = [polyeval(lp,x) for x in xlist]

def f(x):
	return abs(x*polyeval(polydiffn(lp.copy(),2),x)+2*polyeval(polydiff(lp.copy()),x)+polyeval(lp,x)**3)

print(integrate(f,0,30)/30)

plt.plot(xlist,cylist, "-g",label="Chebyshev Basis Solution")
plt.plot(xlist,lylist,"-r",label="Laguerre Basis Solution")
plt.legend()
plt.show()